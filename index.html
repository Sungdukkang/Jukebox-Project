<html>
<head>
	<title>Cue</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>
	<form id="searchbox" method="get" action="" name="search">
		<h1>Search</h1>
		<label>Keywords: </label><input type="text" id="query" name="query" />
		<input type="submit" value="Search" name="submit" />
	</form>

	<div id="results">test</div>
	<div id="message">test</div>

	<script type="text/javascript">
		$("form#searchbox").submit(function( event ) {
			event.preventDefault();
			url = "/api/results.json?" + $(this).serialize();
			$.getJSON(url).done(function(data) {
				$('#results').empty();
				$('#message').empty();
				if ("message" in data) {
					$("message").append(data.message);
				};
				if ("query" in data){
					var caption = "<strong>Results for: " + data.query + "</strong>";
					$("#results").append(caption)
					
					for (var i = 1; i <= data.tracks.length; i++) {
						var trackInfo = $("<div></div>");
						var title = "<p>" + data.tracks[i].track_title + "</p>";
						var user = "<p>" + data.tracks[i].user + "</p>";
						trackInfo.append(title);
						trackInfo.append(user);
						$("#message").append(trackInfo);
					};
				};	
			});
		});
	</script>

</body>
</html>